{% extends "base.html" %}

{% block styles %}
    {{ super() }}

    <link rel="stylesheet" href="{{ url_for('static', filename='css/elective/student/main.css') }}">

{% endblock %}

{% block content %}

    <div class="center-align">

        {% if enroll_open %}
            <h1 class="center-align black-text title">Elective Enroll for Trimester <?php echo $tri_nbr . ", ". $course_year?></h1>
            <h6 class="center-align black-text close">Elective registration closes on <?php echo date("l, F jS, Y", $end_date). " at " . date("g:i a", $end_date) . "."?></h6>
        {% else %}
            <h1 class="center-align black-text title">Elective registration opens on <?php echo date("l, F jS, Y", $start_date) . " at " . date("g:i a", $start_date) . "."?></h1>
        {% endif %}

    </div>

    {%  if sections %}
        <div class="main container white z-depth-2">
            <div class="row head">
                <div id="project_current">

                    <div class="row">
                        <div class="col s6 ">
                            <h3 style="margin-top: 17px;">My Electives:</h3>
                        </div>
                    </div>

                    <div class="row valign-wrapper" style="margin-bottom: 0px;">

                        <div class="col s6">
                            <div class="center-align">
                                <h2 style="margin-top: 17px;" id="curr_project_label"><b><?php echo get_current_project($usr_id)['project_name']; if (empty(get_current_project($usr_id))) {?> None <?php } ?></b></h2>
                            </div>
                        </div>

                        <div class="col s6">
                            <div class="center-align">
                                <a class="disenroll btn red lighten-3" id="disenroll" onclick="submitProject(<?php echo get_current_project($usr_id)['project_id'] ?>, 'disenroll')">Disenroll</a>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    {% endif %}

<div class="main container white z-depth-2">
    <div class="section" id="project_list">
        <h3 class="center-align">Available Electives</h3>
        <table class="highlight responsive-table centered">
            <thead>
            <tr>
                <th></th>
                <th>Name</th>
                <th>Teacher</th>
                <th>Room</th>
                <th>Max</th>
            </tr>
            </thead>
            <?php foreach ($projectsList as $project) { ?>
                <?php if (($curr_project['project_id'] != $project['project_id'])) {?>
                <tr style="font-weight: 300;">
                    <td><a class="modal-trigger" href="#modal<?php echo $project['project_id'] ?>"><i class="material-icons tiny">info_outline</i></a></td>
                    <td><?php echo $project['project_name'] ?></td>
                    <td><?php echo $project['teacher'] ?></td>
                    <td><?php echo $project['room_nbr'] ?></td>
                    <td><?php echo $project['max_nbr'] ?></td>
                    <td>
                        <a class="enroll btn green lighten-3" id="enroll" onclick="submitProject(<?php echo $project['project_id'] ?>, 'enroll')">Enroll</a>
                    </td>
                </tr>

                <div class="modal" id="modal<?php echo $project['project_id']?>">
                    <div class="modal-content">
                        <h1><?php echo $project['project_name'] ?></h1>
                        <h5><?php echo $project['teacher'] ?></h5>
                        <p class="flow-text">Project Description:&nbsp;<?php echo $project['project_desc'] ?></p>
                        <p class="flow-text">Prerequisites:&nbsp;<?php echo $project['prereq'] ?></p>
                    </div>
                    <div class="modal-footer">

                    </div>
                </div>

            <?php } } ?>
        </table>
    </div>
</div>
<script>
    function submitProject(project_id, action) {
        window.location.href = "index.php?action=project_" + action + "&project_id=" + project_id;
    }
</script>
<script>
    $(document).ready(function () {
        let signup = ({{ enroll_open }});
        let enroll = ({{ enroll_open }});

        if (signup) {
            if (enroll) {
                $(".enroll").removeClass("disabled");
                $(".disenroll").addClass("disabled");
            } else {
                $(".enroll").addClass("disabled");
                $(".disenroll").removeClass("disabled");
            }
        }
        else {
            $(".enroll").addClass("disabled");
            $(".disenroll").addClass("disabled");
        }
    });
</script>
<script>
    $('.modal').modal({
        inDuration: 100, // Transition in duration
        outDuration: 100 // Transition out duration
    });
</script>

{% endblock %}